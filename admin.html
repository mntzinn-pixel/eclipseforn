<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Painel Admin</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{margin:0;font-family:Arial;background:#f1f5f9;}
.topbar{background:#111;color:white;padding:15px;font-size:18px;}
.layout{display:flex;}
.sidebar{
 width:230px;
 background:#1e293b;
 height:100vh;
 color:white;
 padding-top:20px;
}
.sidebar div{
 padding:15px;
 cursor:pointer;
}
.sidebar div:hover{
 background:#334155;
}
.content{
 flex:1;
 padding:20px;
}
.card{
 background:white;
 padding:20px;
 border-radius:10px;
 margin-bottom:20px;
 box-shadow:0 3px 10px rgba(0,0,0,0.05);
}
input,select{
 width:100%;
 padding:8px;
 margin:5px 0;
}
button{
 padding:6px 10px;
 border:none;
 border-radius:5px;
 cursor:pointer;
 margin-top:5px;
}
.btn{background:#111;color:white;}
.btn-edit{background:orange;color:white;}
.btn-del{background:red;color:white;}
.hidden{display:none;}
table{
 width:100%;
 border-collapse:collapse;
}
th,td{
 padding:10px;
 border-bottom:1px solid #ddd;
 text-align:left;
}
</style>
</head>
<body>

<div class="topbar">Painel Administrativo</div>

<div class="layout">

<div class="sidebar">
  <div onclick="mostrar('dashboard')">üìä Dashboard</div>
  <div onclick="mostrar('pedidos')">üì¶ Pedidos</div>
  <div onclick="mostrar('produtos')">üõç Produtos</div>
  <div onclick="mostrar('categorias')">üóÇ Categorias</div>
</div>

<div class="content">

<!-- DASHBOARD -->
<div id="dashboard">
  <div class="card">
    <h2>Total Vendido: R$ <span id="totalVendido">0</span></h2>
    <canvas id="grafico"></canvas>
  </div>
</div>

<!-- PEDIDOS -->
<div id="pedidos" class="hidden">
  <div id="listaPedidos"></div>
</div>

<!-- PRODUTOS -->
<div id="produtos" class="hidden">

  <div class="card">
    <h3>Criar / Editar Produto</h3>
    <input id="pNome" placeholder="Nome">
    <input id="pPreco" type="number" placeholder="Pre√ßo">
    <input id="pImagem" placeholder="URL da imagem">
    <select id="pCategoria"></select>
    <input type="hidden" id="pId">
    <button class="btn" onclick="salvarProduto()">Salvar</button>
  </div>

  <div class="card">
    <h3>Lista de Produtos</h3>
    <table>
      <thead>
        <tr>
          <th>Nome</th>
          <th>Pre√ßo</th>
          <th>A√ß√µes</th>
        </tr>
      </thead>
      <tbody id="tabelaProdutos"></tbody>
    </table>
  </div>

</div>

<!-- CATEGORIAS -->
<div id="categorias" class="hidden">

  <div class="card">
    <h3>Criar / Editar Categoria</h3>
    <input id="cNome" placeholder="Nome da categoria">
    <input type="hidden" id="cId">
    <button class="btn" onclick="salvarCategoria()">Salvar</button>
  </div>

  <div class="card">
    <h3>Lista de Categorias</h3>
    <table>
      <thead>
        <tr>
          <th>Nome</th>
          <th>A√ß√µes</th>
        </tr>
      </thead>
      <tbody id="tabelaCategorias"></tbody>
    </table>
  </div>

</div>

</div>
</div>

<script>
const firebaseConfig={
  apiKey:"SUA_API_KEY",
  authDomain:"SEU_AUTH",
  projectId:"SEU_PROJECT_ID"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();

function mostrar(sec){
 ["dashboard","pedidos","produtos","categorias"].forEach(s=>{
   document.getElementById(s).classList.add("hidden");
 });
 document.getElementById(sec).classList.remove("hidden");
}

/* PRODUTOS */

function salvarProduto(){
 let id=pId.value;
 let dados={
   nome:pNome.value,
   preco:parseFloat(pPreco.value),
   imagem:pImagem.value,
   categoria:pCategoria.value
 };

 if(id){
   db.collection("produtos").doc(id).update(dados);
 }else{
   db.collection("produtos").add(dados);
 }

 pNome.value="";
 pPreco.value="";
 pImagem.value="";
 pId.value="";
}

db.collection("produtos").onSnapshot(snapshot=>{
 let tabela=document.getElementById("tabelaProdutos");
 tabela.innerHTML="";
 snapshot.forEach(doc=>{
   let p=doc.data();
   tabela.innerHTML+=`
   <tr>
     <td>${p.nome}</td>
     <td>R$ ${p.preco}</td>
     <td>
       <button class="btn-edit" onclick="editarProduto('${doc.id}','${p.nome}','${p.preco}','${p.imagem}','${p.categoria}')">Editar</button>
       <button class="btn-del" onclick="excluirProduto('${doc.id}')">Excluir</button>
     </td>
   </tr>`;
 });
});

function editarProduto(id,nome,preco,imagem,categoria){
 pId.value=id;
 pNome.value=nome;
 pPreco.value=preco;
 pImagem.value=imagem;
 pCategoria.value=categoria;
}

function excluirProduto(id){
 db.collection("produtos").doc(id).delete();
}

/* CATEGORIAS */

function salvarCategoria(){
 let id=cId.value;
 let dados={nome:cNome.value};

 if(id){
   db.collection("categorias").doc(id).update(dados);
 }else{
   db.collection("categorias").add(dados);
 }

 cNome.value="";
 cId.value="";
}

db.collection("categorias").onSnapshot(snapshot=>{
 let tabela=document.getElementById("tabelaCategorias");
 let select=document.getElementById("pCategoria");
 tabela.innerHTML="";
 select.innerHTML="";
 snapshot.forEach(doc=>{
   let c=doc.data();
   tabela.innerHTML+=`
   <tr>
     <td>${c.nome}</td>
     <td>
       <button class="btn-edit" onclick="editarCategoria('${doc.id}','${c.nome}')">Editar</button>
       <button class="btn-del" onclick="excluirCategoria('${doc.id}')">Excluir</button>
     </td>
   </tr>`;
   select.innerHTML+=`<option value="${c.nome}">${c.nome}</option>`;
 });
});

function editarCategoria(id,nome){
 cId.value=id;
 cNome.value=nome;
}

function excluirCategoria(id){
 db.collection("categorias").doc(id).delete();
}
</script>

</body>
</html>
