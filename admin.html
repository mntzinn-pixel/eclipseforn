<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel Admin</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>

<style>
body{
  font-family:Arial;
  background:#0f172a;
  color:white;
  padding:20px;
}

input{
  width:100%;
  padding:10px;
  margin:5px 0;
  border-radius:8px;
  border:none;
}

button{
  padding:10px;
  width:100%;
  border:none;
  border-radius:8px;
  background:#22c55e;
  color:white;
  font-weight:bold;
  cursor:pointer;
}

.card{
  background:#1e293b;
  padding:10px;
  margin-top:10px;
  border-radius:8px;
}
</style>
</head>
<body>

<h2>Painel Admin</h2>

<input type="text" id="nome" placeholder="Nome do produto">
<input type="number" id="preco" placeholder="PreÃ§o">
<input type="file" id="imagem">

<button onclick="salvarProduto()">Salvar Produto</button>

<div id="lista"></div>

<script>
const firebaseConfig={
  apiKey:"AIzaSyDAnBNdufwLlMW4bZHK0mUgncmIezNSMTg",
  authDomain:"minha-loja-digital1.firebaseapp.com",
  projectId:"minha-loja-digital1",
  storageBucket:"minha-loja-digital1.appspot.com"
};

firebase.initializeApp(firebaseConfig);

const db=firebase.firestore();
const storage=firebase.storage();

function salvarProduto(){

  const nome=document.getElementById("nome").value;
  const preco=parseFloat(document.getElementById("preco").value);
  const arquivo=document.getElementById("imagem").files[0];

  if(!arquivo){
    alert("Selecione uma imagem!");
    return;
  }

  const storageRef=storage.ref("produtos/"+Date.now()+"_"+arquivo.name);

  storageRef.put(arquivo).then(snapshot=>{
    snapshot.ref.getDownloadURL().then(url=>{

      db.collection("produtos").add({
        nome:nome,
        preco:preco,
        imagem:url
      }).then(()=>{
        alert("Produto salvo com sucesso!");
        document.getElementById("nome").value="";
        document.getElementById("preco").value="";
        document.getElementById("imagem").value="";
      });

    });
  });
}

db.collection("produtos").onSnapshot(snapshot=>{
  let lista=document.getElementById("lista");
  lista.innerHTML="";
  snapshot.forEach(doc=>{
    let p=doc.data();
    lista.innerHTML+=`
      <div class="card">
        <img src="${p.imagem}" width="100%">
        <p>${p.nome}</p>
        <p>R$ ${p.preco}</p>
      </div>
    `;
  });
});
</script>

</body>
</html>
