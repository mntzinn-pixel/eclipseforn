<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Admin - Minha Loja</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
</head>

<body style="font-family: Arial; padding:20px; background:#f5f5f5;">

  <h1>ğŸ” Painel Admin</h1>

  <h3>Adicionar Produto</h3>

  <input type="text" id="nome" placeholder="Nome do produto" style="padding:10px;width:100%;margin-bottom:10px;">
  <input type="number" id="preco" placeholder="PreÃ§o" style="padding:10px;width:100%;margin-bottom:10px;">
  <input type="file" id="imagem" accept="image/*" style="margin-bottom:10px;">
  
  <button onclick="cadastrarProduto()" style="padding:10px;width:100%;background:green;color:white;border:none;border-radius:5px;margin-bottom:30px;">
    Cadastrar Produto
  </button>

  <h3>Produtos Cadastrados</h3>
  <div id="lista-admin"></div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDAnBNdufwLlMW4bZHK0mUgncmIezNSMTg",
      authDomain: "minha-loja-digital1.firebaseapp.com",
      projectId: "minha-loja-digital1",
      storageBucket: "minha-loja-digital1.firebasestorage.app",
      messagingSenderId: "119834670597",
      appId: "1:119834670597:web:36edb828d7fdded6678e6c"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    function cadastrarProduto() {
      const nome = document.getElementById("nome").value;
      const preco = document.getElementById("preco").value;
      const arquivo = document.getElementById("imagem").files[0];

      if (!nome || !preco || !arquivo) {
        alert("Preencha todos os campos!");
        return;
      }

      const reader = new FileReader();

      reader.onload = function(e) {
        const imagemBase64 = e.target.result;

        db.collection("produtos").add({
          nome: nome,
          preco: parseFloat(preco),
          imagem: imagemBase64,
          criadoEm: new Date()
        }).then(() => {
          alert("Produto cadastrado!");
          document.getElementById("nome").value = "";
          document.getElementById("preco").value = "";
          document.getElementById("imagem").value = "";
          carregarAdmin();
        });
      };

      reader.readAsDataURL(arquivo);
    }

    function excluirProduto(id) {
      db.collection("produtos").doc(id).delete().then(() => {
        alert("Produto excluÃ­do!");
        carregarAdmin();
      });
    }

    function carregarAdmin() {
      const lista = document.getElementById("lista-admin");
      lista.innerHTML = "";

      db.collection("produtos").get().then(snapshot => {
        snapshot.forEach(doc => {
          const data = doc.data();

          lista.innerHTML += `
            <div style="background:white;padding:10px;margin:10px 0;border-radius:8px;">
              <img src="${data.imagem}" style="width:100px;border-radius:5px;">
              <p><strong>${data.nome}</strong></p>
              <p>R$ ${data.preco}</p>
              <button onclick="excluirProduto('${doc.id}')" 
                style="background:red;color:white;border:none;padding:5px 10px;border-radius:5px;">
                Excluir
              </button>
            </div>
          `;
        });
      });
    }

    document.addEventListener("DOMContentLoaded", carregarAdmin);
  </script>

</body>
</html>
